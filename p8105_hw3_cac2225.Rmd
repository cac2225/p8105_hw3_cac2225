---
title: "p8105_hw3_cac2225"
author: "Courtney Chan"
date: "October 8, 2018"
output: github_document
---

#Problem 1

## First load dataset

```{r loading BRSS data}

library(p8105.datasets)
brfss_smart2010 = brfss_smart2010

```

```{r upload necessary packages}

library(tidyverse)
library(dplyr)
library(ggplot2)

```

To clean the dataset, the variable names will be cleaned using the janitor package, function clean_names. Change the variable names as needed.
The data is filtered based on topic, Overall Health, and responses Excellent to Poor. The response variable will be turned into a factor variable and its responses ordered.

```{r data cleaning step}
brfss_smart2010 = janitor::clean_names(brfss_smart2010)

filtered_brfss_smart2010 = filter(brfss_smart2010, topic == "Overall Health") %>% 
  filter(response == "Excellent" | response == "Very Good" | response == "Good" | response == "Fair" | response == "Poor") %>% 
  mutate(response = factor(response, levels = str_c(c("Excellent", "Very Good", "Good", "Fair", "Poor"))))
```


```{r states observed at 7 locations in 2002}
filtered_brfss_smart2010 %>% 
  filter(year == "2002") %>% 
  distinct(locationdesc) %>% 
  separate(locationdesc, into = c("state", "county"), sep = "-") %>%   
  count(state) %>% 
  filter(n == 7)
```

To determine how many states were observed at 7 county locations, the number of distinct state-county values were determined, these values were seperated, and the number of times each state occurred was counted. The states that were counted as having appeared 7 times were filtered out.
The states are as follows: CT, FL and NC.

```{r creating spaghetti plot # locations in each state, 2002 - 2010}
filtered_brfss_smart2010 %>% 
  summarize(max_year = max(year), min_year = (min(year)))

plot_spaghetti = filtered_brfss_smart2010 %>% 
  separate(locationdesc, into = c("state", "county"), sep = "-") %>% 
  group_by(year, state) %>% 
  summarize(n_counties = n())

ggplot(plot_spaghetti, aes(x = year, y = n_counties, color = state)) + geom_line()
```

First determined what the minimum and maximum year values are, which are 2002 and 2010, thus no need to filter by year any further. Create a new set of data, named plot_spaghetti, seperating the variable locationdesc to ultimately count the number of times a state is recorded within a certain year. Plot this setting year on the x axis, number of times a state has appeared which equals number of locations per state, and a different color for each state.

table_filt_brss_smart2010 = filtered_brfss_smart2010 %>% 
  filter(year %in% c("2002", "2006", "2010"))
